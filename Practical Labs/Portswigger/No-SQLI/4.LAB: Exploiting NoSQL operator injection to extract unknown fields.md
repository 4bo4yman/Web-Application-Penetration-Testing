## Welcome, my friend. Today we will start the [4. No-SQLI lab](https://portswigger.net/web-security/nosql-injection/lab-nosql-injection-extract-unknown-fields) in ```portswigger```
### Let's play this lab:

![image](https://github.com/user-attachments/assets/c0241535-f751-440a-841d-a60eea06c181)

#### First, we navigate inside the browser

![image](https://github.com/user-attachments/assets/2f0662da-64e1-4a45-8af6-37e396cfa096)

ูููุงุญุธ ููู ูู ุฌุงุฌุฉ ุงุณููุง ***my account*** ูุฏุฎู ูุดูู ุญูุงุฑูุง ุงูู!
![image](https://github.com/user-attachments/assets/73820981-cb6d-4e81-8ff2-ff9e07be4faf)

ุทูุนุช ุตูุญุฉ ุชุณุฌูู ุฏุฎูู ุนุงุฏูุฉ ูุงุญูุง ุนุงูุฒูู ูุฏุฎู ุนูู ุญุณุงุจ carlos ุจุณ ุงููุดููุฉ ุงููุง ูุนุงูุง ุงุณู ุงููุชุณุฎุฏู ููุท ุงูุงุงูุจุงุณูุฑุฏ ูุด ูุนุงูุง 
ููุงุญุธ ุชุญุช ูู ```forgot password?``` ุชุนุงูู ูุฏุฎู ูุดูููุง
![image](https://github.com/user-attachments/assets/107f4eab-e327-471d-a9af-b8ea713f38c8)
ุชุนุงูู ุฏูููุชู ูุฏุฎู ุงุณู ุงููุณุชุฎุฏู ***carlos***
![image](https://github.com/user-attachments/assets/d6226dc2-600a-48cc-a899-bf33eea78178)
ุงูููุฑูุถ ุงู ูู ููู ูุตู ููุงุฑูุณ ูุงุญูุง ูุด ูุนุงูุง ุงูููู !! ุทุจ ูุงูุนูู ุชุนุงูู ูุฑุฌุน ุชุงูู ูุตูุญุฉ ุงูุชุณุฌูู ููุฏุฎู ุงุณู ุงููุณุชุฎุฏู ****carlos*** ููููุฉ ุงูุณุฑ ุงู ุญุงุฌุฉ ููููุท ุงูุทูุจ ูู ุงูุจูุฑุจ
![image](https://github.com/user-attachments/assets/e7a54ed1-5ce5-49ff-a932-70c924cb3039)

ููุงุญุธ ููุง ูุชุจูุง ุจุงุณูุฑุฏ ูุด ุตุญูุญ ุทูุน ุชูู ุงูุฑุณุงูุฉ 
```
Invalid username or password
```

ุทูุจ ุงูู ุฑุงูู ููุชุจ ูู ุงูุจุงุณูุฑุฏ ุงูุญูู ุฏู
```
{"$ne":"non"}
```

![image](https://github.com/user-attachments/assets/d8e5f3e7-37b4-46b6-b375-11c4ff341d1b)

ููุงุฌุธ ุงูุฑุณุงูุฉ ุงุชุบูุฑุช ุจูุช ูุฏู
```
Account locked: please reset your password
``` 

ุงูุฑุณุงูุฉ ุฏู ุชุซุจุชููุง ุงููุง ูุฌุญูุง ูู ุงูุญูู ูุจุฏุฃ ูุญุงูู ูุทูุน ุจูุงูุงุช ูููุฉ ูู ุงูุณูุฑูุฑ ููุง ุจููุง ูุจุฏุฃ ูุนุฑู ุงู keys ูู ุงู database ููุจุฏุฃ ูุณุชุฎุฏู operator ุงุณูู which ููุง ุจููุง ูุดููู ุณูุง
```
"$where":"Object.keys(this)[0].match('^.{0}i.*')"
```


![image](https://github.com/user-attachments/assets/c5652888-cc1d-451d-90dd-f9b27e3edfce)

ูุฏู ูุนูุงู ุงูู ุจุณุงูู ุงูู key ูุงูู ุญุฑู ููู ูู i ูุธูุฑูู ุฑุณุงูุฉ ุงู ***invalid*** ูุฏู ูุนูุงู ุงูู ูุด ุญุฑู ุงู i ูููุทูุน ุญุฑู ***_***


![image](https://github.com/user-attachments/assets/3070366e-79be-4b47-87ce-a3e2e4dbb51a)

ูุทุจุนุง ุนุงุฑููู ุงูู ูุชุธูุฑ ุงู Account locked ูุจูุง ูุฏู ุงูุดุฑุท ุตุญ ุงูู ุญุฑู ูู ุงู _
ุนุงูุฒูู ูุฌูุจ ุงูุญุฑู ุงูุชุงูู ููุบูุฑ ุงู 0 ู 1 ุฒู ูุฏู
```
"$where":"Object.keys(this)[0].match('^.{1}i.*')"
```

ููู ุนุงูุฒูู ูุฌูุจ ุงู key ุงูุชุงููุฉ ููุบูุฑ ุงูุตูุฑ ุงูุงููุงูู ู 1 ุฒู ูุฏู


```
"$where":"Object.keys(this)[1].match('^.{0}i.*')"
```

ุงูุญูู ุฏู ุจูุฏูุฑ ุนูู ุงู key ุงูุชุงููุฉ ูุจูุฏูุฑ ุนูู ุงูู ุญุฑู ููู

ุจุนุฏ ูุญุงููุงุช ุจุงูุงูุชุฑูุฏุฑ ุนุฑููุง ุงู ุงูุณูุณูุฉ ูุชุจูุง ูุฏู 
```
{_id,username,password,email,????}
```

ุงููุบุฒ ููู ูู ุงู key ุงูุฎุงูุณุฉ ุทูุจ ุนุงูุฒูู ูุญุฏุฏ ุนุฏุฏ ุญุฑูู ุงููููุฉ ููุจุฏุฃ ูุณุชุฎุฏู ุงูุญูู ุงูุชุงูู

```
"$where":"Object.keys(this)[4].length==6"
```

![image](https://github.com/user-attachments/assets/8ecdc3cf-76fe-45e7-9744-99c762bbdfcd)

ูุจูุง ุงูู ุงููููุฉ ***invalid*** ูุจูุง ุนุฏุฏ ุงูุญุฑูู ูุด 6 ูุจูุง ูุบูุฑูุง ูุบุงูุฉ ูููุตู ููููุฉ ***Account locked***:
![image](https://github.com/user-attachments/assets/60b26258-b2e8-4d3f-9795-c1af43ff7158)

ูุจูุง ุนุฏุฏ ุงูุญุฑูู 13 ุนุงูุฒูู ุจูุง ูุนุฑู ุงูู ููุง ุงู 8 ุญุฑูู ุฏูู ูุจูุง ูุณุชุฎุฏู ุงูุงูุชุฑูุฏุฑ ููุณุชุฎุฏู ุงูุญูู ุงูุชุงูู

```
"$where":"Object.keys(this)[4].match('^.{ยง0ยง}ยงaยง.*')"
```

ูุฏู ุงุญูุง ููุณุชุฎุฏู ุงูุงูุชุฑูุฏุฑ ููุณุชุฎุฏู ุงูู ุชุฎููู ูููู ุน ุงูุงุฑูุงู ูู 0 ู 12 ูุงู ููุง 13 ุญุฑู ูุชุงูู ุชุฎููู ูููู ***simple list*** ููู ูู a-z
![image](https://github.com/user-attachments/assets/46246a18-abbc-4e75-9443-05d618c61708)

ุชุนุงูู ูุฌูุน ุงู 13 ุญุฑู ููุทูุน ูุนุงูุง ```passwordReset```

ุจุนุฏ ูุนุฑููุง ุงู Key ุงูุฎุงูุณุฉ ุนุงูุฒูู ูุนุฑู ูุญุชูุงูุง ููุนุฑูู ูู ุงูุญูู ุงูุชุงูู
```
"$where":"this.passwordReset.match('^.{0}a.*')"
```

ุจุณ ุงูุงูู ุนุงูุฒูู ูุนุฑู ุนุฏุฏ ุญุฑูู ุงููููุฉ ููุจุฏุฃ ูุณุชุฎุฏู ุงูุญูู ุงูุชุงูู
```
"$where": "this.passwordReset.length==8"
```

![image](https://github.com/user-attachments/assets/f60e0cf9-da82-4554-9585-f0dc24f74f9a)

ุนุฏุฏ ุงูุญุฑูู ูุด 8 ููุฑุฑ ูุบุงูุฉ ูููุตู ููุฑูู ุงูุตุญ
![image](https://github.com/user-attachments/assets/62d50372-b530-49fb-bb09-27f69414e014)
ุนุฑููุง ุงู ุนุฏุฏ ุงูุญุฑูู ูู 16 ูุจุฏุฃ ูุญุฏุฏ ุงูุญุฑูู ูู ุฎูุงู ุงูุญูู ุงูุชุงูู

```
"$where":"this.passwordReset.match('^.{ยง0ยง}ยงaยง.*')"
```

ูุฏู ุงุญูุง ููุณุชุฎุฏู ุงูุงูุชุฑูุฏุฑ ููุณุชุฎุฏู ุงูู ุชุฎููู ูููู ุน ุงูุงุฑูุงู ูู 0 ู 12 ูุงู ููุง 13 ุญุฑู ูุชุงูู ุชุฎููู ูููู ***simple list*** ููู ูู a-z ููุฐูู ูู A-Z ูุงูุถุง ูู 0 ุงูู 9 ููุจุฏุฃ ุงููุฌูู

![image](https://github.com/user-attachments/assets/7e2b12bc-3342-4740-b3a6-4fda63a8f6cc)

ุชุนุงูู ูุฌูุน ุงู 16 ุญุฑู ููุทูุน ูุนุงูุง ```9a0d2e4218ef6b27``` ุฌููู ุงูู
ูุงูุฑ ูุง ุตุฏููู ููุง ุฏุฎููุง ูู ุงูู ุงูุชุฌุฏู ุนูู ุตูุญุฉ ุงุณููุง forgot password ุชุนุงูู ูุฑุฌุนููุง ููุถูู ูู ุงู url ุงูุจุฑุงูุชุฑ ุงููู ุทูุนูุงู ุณูุง ููู ***passwordReset*** ููุถูู ูููุชู ุงููู ุทูุนูุงู ุณูุง ุจุฑุถู ุงููู ูู ***9a0d2e4218ef6b27*** ูุงูุชุงูู

```
/forgot-password?passwordReset=9a0d2e4218ef6b27
```

![image](https://github.com/user-attachments/assets/dfba2b5c-9156-4565-b237-9b9a75922f78)

ูุฏูููุชู ูุง ุตุฏููู ุชูุฏุฑ ุชุบูุฑ ุงูุจุงุณูุฑุฏ ูุงู ุจุงุณูุฑุฏ ุงูุช ุชุญุจู ุงูู ุฑุงูู ูุฎููู ***0xT0R***

ูุฏูููุชู ุชุนุงูู ูุฏุฎู ูุณุฌู ุฏุฎูู ุจุงุณู ุงููุณุชุฎุฏู ***carlos*** ููููุฉ ุงูุณุฑ ูู ***0xT0R***

![image](https://github.com/user-attachments/assets/a9f8496b-57f6-4c30-ba41-ba726c1123e9)


ูุงุฎูุฑุงุงุงุง ูุง ุตุฏููู ุญูููุง ุงููุงุจ ุณูู ุงุณุชูุชุนุช ุจุงููุดุงุฑูุฉ ูุนุงู ููุชูู ูุฑูุจุง ูู ูุงุจ ุฌุฏูุฏ.
-------

### Done! Congratulations, friendsโค๏ธโ๐ฅ


<p align="center">
<img src="https://github.com/user-attachments/assets/65592ffa-eb93-4e08-b775-e91b4524da0c" width="400" height="350">
</p>









